$(function(){
    var $section=$('.form-section');
    var proses=0;
    $('.progress-bar').css('width', proses+'%').attr('aria-valuenow', proses);
    function navigateTo(index){
        $section.removeClass('current').eq(index).addClass('current');
        $('.navnav .preve').toggle(index>0);
        var atTheEnd = index >= $section.length - 1;
        $('.navnav .nekt').toggle(!atTheEnd);
        $('.navnav [type=submit]').toggle(atTheEnd);
    }

    function curIndex(){
        return $section.index($section.filter('.current'));
    }

    $('.navnav .preve').click(function(){
        navigateTo(curIndex()-1);
        proses-=15;
        $('.progress-bar').css('width', proses+'%').attr('aria-valuenow', proses);
    });
    $('.navnav .nekt').click(function(){
        $('.contak-form').parsley().whenValidate({
            group: "block-"+curIndex(),
            messages:'Isian ini dibutuhkan',
        }).done(function(){
            navigateTo(curIndex()+1);
            proses+=15;
            $('.progress-bar').css('width', proses+'%').attr('aria-valuenow', proses);
        });

    });

    $section.each(function(index, section){
        $(section).find(':input').attr('data-parsley-group','block-'+index);

    });
    navigateTo(0);
    $('#dropdownpks .dropdown-menu a').click(function(){
       if ( $(this).text()=='Ya') {
            $('.form-section .kps').addClass('current');
            $('.kps input').attr('required', 'true');
            // console.log($(this).text());
       }else{
           $('.kps input').removeAttr('required');
           $('.form-section .kps').removeClass('current');
       }
    //    console.log('clik di kps');
    });
    $('#pendayah .dropdown-menu a').click(function(){
        $('#pendayah button').text($(this).text()).val($(this).text());
        $('#forpendayah').text($(this).text()).val($(this).text());
    });
    $('#penghayah .dropdown-menu a').click(function(){
        $('#penghayah button').text($(this).text()).val($(this).text());
        $('#forpenghayah').text($(this).text()).val($(this).text());
    });
    $('#pendibu .dropdown-menu a').click(function(){
        $('#pendibu button').text($(this).text()).val($(this).text());
        $('#forpendibu').text($(this).text()).val($(this).text());
    });
    $('#penghibu .dropdown-menu a').click(function(){
        $('#penghibu button').text($(this).text()).val($(this).text());
        $('#forpenghibu').text($(this).text()).val($(this).text());
    });
    $('#pendwali .dropdown-menu a').click(function(){
        $('#pendwali button').text($(this).text()).val($(this).text());
        $('#forpendwali').text($(this).text()).val($(this).text());
    });
    $('#penghwali .dropdown-menu a').click(function(){
        $('#penghwali button').text($(this).text()).val($(this).text());
        $('#forpenghwali').text($(this).text()).val($(this).text());
    });
    $('.jr .dropdown-menu a').click(function(){
        $('.jr #dropdownforjurusan').text($(this).text()).val($(this).text());
        $('.d-flex #forjurusan').val($(this).attr('value')).text($(this).attr('value'));
        // console.log($(this).attr('value'));
    });
    $('.dropdown .dropdown-menu .jk').click(function() {
        // alert($(this).val());
        $('.dropdown #dropdownMenuButtonjk').val($(this).val()).text($(this).text());
        $('#forjk').val($(this).val()).text($(this).text());
    });
    $('.dropdown .dropdown-menu .ag').click(function() {
        // alert($(this).val());
        $('.dropdown #dropdownMenuButtonag').val($(this).val()).text($(this).text());
        $('#foragama').val($(this).val()).text($(this).text());
    });
    $('.dropdown .dropdown-menu .kd').click(function() {
        // alert($(this).val());
        $('.dropdown #dropdownMenuButtonkd').val($(this).val()).text($(this).text());
        $('#forkendaraan').val($(this).val()).text($(this).text());
    });
    $('.dateSis').datepicker({
      format: "yyyy-mm-dd",
      startView: 2,
      clearBtn: true,
      language: "id"
    }).on('changeDate', function(e) {
      $('.vlDate').val($(".dateSis").data('datepicker').getFormattedDate('yyyy-mm-dd'));
    });
});
